"use strict";(self["webpackChunkleaf_blog_front"]=self["webpackChunkleaf_blog_front"]||[]).push([[735],{7735:function(e,s,t){t.r(s),t.d(s,{default:function(){return u}});var a=function(){var e=this,s=e._self._c;return s("div",{staticClass:"userInfo-div"},[s("el-card",{staticClass:"box-card_title"},[s("div",{staticClass:"welcome_div"},[s("div",{staticClass:"text item"},[e._v("我的资料")]),s("div",{staticClass:"welcome"},[e._v("以下是您的资料卡，欢迎完善或更改信息！")])])]),s("el-card",{staticClass:"box-card userInfo-card"},[s("div",{staticClass:"userInfo-box"},[s("div",{staticClass:"userInfo-img"},[s("el-upload",{staticClass:"avatar-uploader",attrs:{"http-request":e.upLoad,"show-file-list":!1,"on-success":e.handleAvatarSuccess,name:"file",action:e.uploadUrl,"before-upload":e.beforeAvatarUpload}},[e.userInfo.headimg?s("img",{staticClass:"headimg-css",attrs:{src:e.userInfo.headimg}}):e._e(),e.userInfo.headimg?e._e():s("el-avatar",{staticStyle:{"font-size":"38px"},attrs:{size:100,src:e.userInfo.headimg}},[e._v(e._s(e.userInfo.username.charAt(0)))])],1)],1),s("el-form",{ref:"updateForm",staticClass:"demo-ruleForm",attrs:{model:e.userInfo,rules:e.rules}},[s("el-form-item",{attrs:{prop:"username"}},[s("div",{staticClass:"input-css",staticStyle:{width:"300px"}},[s("span",{staticStyle:{width:"60px"}},[e._v("用户名 ")]),s("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"Username"},model:{value:e.userInfo.username,callback:function(s){e.$set(e.userInfo,"username",s)},expression:"userInfo.username"}})],1)]),s("el-form-item",{attrs:{prop:"email"}},[s("div",{staticClass:"input-css",staticStyle:{width:"300px"}},[e._v(" 邮   箱 "),s("el-input",{staticStyle:{width:"80%"},attrs:{value:e.userInfo.email,disabled:"",placeholder:"Email"}})],1)]),s("el-form-item",{attrs:{prop:"password"}},[s("div",{staticClass:"input-css",staticStyle:{width:"300px"}},[e._v(" 密   码 "),s("el-input",{staticStyle:{width:"80%"},attrs:{value:e.userInfo.password,disabled:"",placeholder:"Password"}})],1)]),s("el-form-item",{attrs:{prop:"phonenumber"}},[s("div",{staticClass:"input-css",staticStyle:{width:"300px"}},[e._v(" 手机号 "),s("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"PhoneNum"},model:{value:e.userInfo.phonenumber,callback:function(s){e.$set(e.userInfo,"phonenumber",s)},expression:"userInfo.phonenumber"}})],1)]),s("el-form-item",{attrs:{prop:"createtime"}},[s("div",{staticClass:"input-css",staticStyle:{width:"300px"}},[e._v(" 注册时间 "),s("span",{staticClass:"createtime-span"},[e._v(" "+e._s(e.userInfo.createtime)+" ")])])]),s("div",{staticClass:"button-css"},[s("el-button",{staticClass:"login-button-home",attrs:{type:"info"},on:{click:e.gotoMain}},[e._v("返回首页")]),s("el-button",{staticClass:"login-button",attrs:{type:"info"},on:{click:e.updateInfo}},[e._v("修改信息")])],1)],1)],1)])],1)},r=[],i=(t(7658),{data(){var e=async(e,s,t)=>{if(""!=s){const e=await this.checkUserName();e?t(new Error("用户名已存在，请重新输入！")):t()}t()};return{uploadUrl:"",rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:["blur","change"]},{validator:e,trigger:"blur"}],phonenumber:[{required:!0,message:"请输入手机号",trigger:"blur"},{required:!0,pattern:/^[1][3,4,5,7,8,9][0-9]{9}$/,message:"请输入正确的手机号",trigger:"blur"}]},userInfo:{headimg:"",username:"",phonenumber:""}}},methods:{gotoMain(){this.$store.dispatch("asyncUpdatedActiveIndex","/main"),this.$router.push("/main")},async checkUserName(){const e=await this.$api.user.checkUserName({username:this.userInfo.username});return 200!==e.data.code},async updateInfo(){this.$refs.updateForm.validate((async e=>{if(e){const e=await this.$api.user.updateNameAndPhone(this.userInfo);200===e.data.code?(this.$message.success("修改成功！"),this.userInfo=e.data.data,window.sessionStorage.setItem("userInfo",JSON.stringify(e.data.data))):this.$message.error(e.data.msg)}}))},beforeAvatarUpload(e){const s="image/jpeg"==e.type||"image/png"==e.type||"image/gif"==e.type,t=e.size/1024/1024<2;return s||this.$message.error("上传头像图片只能是 JPG/PNG/GIF 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),s&&t},upLoad(e){const s=new FormData;s.append("file",e.file),this.$api.user.uploadUserImage(s).then((e=>{console.log(e),console.log("上传成功"),200===e.data.code?(this.$message.success(e.data.msg),this.userInfo.headimg=e.data.data):this.$message.error(e.data.msg)}))},handleAvatarSuccess(){}},mounted(){this.userInfo=JSON.parse(window.sessionStorage.getItem("userInfo")),this.$store.dispatch("asyncUpdatedActiveIndex","/user/userInfo")}}),o=i,n=t(1001),l=(0,n.Z)(o,a,r,!1,null,"739a03dc",null),u=l.exports}}]);
//# sourceMappingURL=735.9fd1ce45.js.map